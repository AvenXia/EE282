---
title: Project Analysis Proposal
Name: Qingyuan Xia
---

# Introduction
Focal cortical dysplasia (FCD) is a developmental abnormality of cortical architecture. Yet the molecular mechanism causing FCD is still unclear. Based on the last project topic proposal, we've discussed the background knowledge of FCD and how single-cell/nuclei RNA sequencing may promote our understanding on FCD. In this proposal, the data analysis design of this project will be explained, including identifying the dataset for this project, the main goals of this analysis and steps for data processing and visualization.

# Identifying the dataset
The datasets to be utilized is the single nuclei RNA sequencing data of neocortex from three transgenetic mice from my lab. Three groups of sn-RNA datasets were collected at different stages of of epilepsy: wildtype (negative control),mild and severe. Followed by nuclei isolation, The resulting clean nuclei preparation were then counted and encapsulated on a 10X Genomics Chromium machine, using the 30 Transcriptome V3.1 kit.After encapsulation, the resulting libraries were reverse transcribed, amplified as cDNA, fragmented, and amplified as a final library following the manufacturer's instructions. The resulting libraries were sequenced on a NovaSeq S4 flowcell (Illumina) to a target depth of 50,000 reads per nucleus. 

Raw reads have been first mapped to the mm10 mouse reference genome and demultiplexed to generate a per-cell count matrix using CellRanger pipeline. Cells of potentially low quality (unique feature counts > 6000 or total UMI < 700 or total UMI > 30,000, or percentage of mitochondrial genes > 10%) were removed from downstream analysis. Therefore, this project will start with the downstream analysis of the matrix. The goal of the analysis will be: (a) Identifying diverse types of cell populations across multiple datasets; (b) Finding the highly expressed genes in different stages of epilepsy; (3) Simulating temporal trajectories of gene expression patterns of specific cell type during epilepsy development. To achieve these goals, the matrix will be analyzed in R using a series of standard methods implemented in packages Seurat v4 and Monocle. 

# Plans on data analysis
## Identifying diverse types of cell populations across multiple datasets
Identifying the cell populations across multiple datasets from different mice brings about the unique problem because of experimental variations (batch effects and disease conditions). To minimize this, the reciprocal PCA method in Seurat package is utilized that projects each dataset into the others PCA space and constrains the anchors by the same mutual neighborhood requirement. Briefly, gene counts are normalized and 2000 highly variable genes are selected in each dataset based on the mean/variance calculations. The features that are repeatedly variable across datasets is selected for integration PCA. After each dataset is scaled and performed with PCA, anchors between individual data are identified for data integration. The integrated data is further scaled and centered followed by regular PCA on purpose of dimension reduction. PC1 to PC30 are chosen to construct a K-nearest neighbor (KNN) graph based on the euclidean distance in PCA space, and the edge weights between any two cells are modified based on Jaccard similarity. The cell clustering in the KNN graph is achieved by applying Louvain algorithm clustering (resolution = 0.6-1.2). If further sub-reclustering is needed, specific cell clusters can be extracted and then clustered based on the identical integrative clustering and DGE method mentioned above.

For clustering visualization, Uniform Manifold Approximation and Projection (UMAP) plots is generated based on the same number of PC (PC1-30) selected above. Based on the canonical reference markers of neuronal and non-neuronal cell types, clusters of each cell type including neuron, astrocyte, oligodendrocyte, microglia, pericytes, Oligo precursor cells, and endothelial cells may be classified.

## Finding the highly expressed genes in different stages of epilepsy
To identify the highly expressed genes in different stages of epilepsy compared with wildtype mice model, clusters of neuron can be extracted based on the canonical markers. The expression value of each gene in each epilepsy stage are compared against the wildtype mouse data using Wilcoxon rank sum test. Upregulated genes recommended with p_value < 0.05, log fold change > 0.25 and minimized pct_difference > 0.1 can be selected. The DEG genelists can be visualized with heatmap using packages pheatmap. For the upregulated genes screened via DGE analysis, gene ontology database (GO Biological Process, GO Molecular Function, and GO Cellular Component) at mouse genome informatics was referenced via R package enrichProfiler to find out enriched ontology (adjusted p_value < 0.1) from the DGE list. GSEA analysis can also be completed via AddModuleScore function and the gene-sets were referenced from GSEA Molecular Signatures Database.

## Simulating temporal trajectories of gene expression patterns of specific cell type during epilepsy development
Pseudo-time analysis is conducted via R package Monocle to find out the linear gene expression alterations. First a specific data of one cell type cluster should be extracted. For monocle analysis, default parameters are used. Cells in WT and every stages of the seizures are ordered into pseudo-time trajectory using the top 2000 high variable genes via orderCells function. Ordering genes with qval < 0.1 for pseudo-time ordering are considered using the differentialGeneTest() function. Ordering genes are clustered based on the expression trajectory using the ward.D2 method from the R package pheatmap. The expression level tracking of ordering genes over pseudo-time can also be visualized by function plot_genes_in_pseudotime from monocle.

# Conclusion
This proposal focuses more on how to design the protocol for data analysis. The data format for this project is explained. To achieve the goals set for this project, the coding language, packages to be utilized and basic data analysis algorithm is briefly explained to claim the feasibility of this project. It is believed that several interesting results may be revealed as potential study direction of FCD mechanism. 